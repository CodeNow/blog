<!doctype html>
<html>

  <title>Runnablog</title>
  <head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="icon" type="image/png" href="/blog/favicon.png">
  <link rel="stylesheet" href="//runnable.com/styles/index.css">
  <link rel="stylesheet" href="/blog/css/index.css">
  <link rel="alternate" type="application/rss+xml" title="Runnable Blog" href="https://runnable.com/blog/feed.xml">
  <meta property="og:image" content="//s3-us-west-1.amazonaws.com/runnable-design/fb-image.png">
  <meta name="description" content="The official blog from the team at Runnable.">
  <meta name="twitter:card" content="summary">
  <meta name="twitter:site" content="@getrunnable">
  
    <meta name="twitter:title" content="Amazon-like Popover Trigger Behaviors in AngularJS">
    <meta name="twitter:description" content="Creating custom UI behavior in Angular can seem daunting. Once you know how to break the problem down, its complexity can just fizzle away. In this tutorial, we’ll be exploring the use of mouse events, locations, and some simple geometry to add an on-hover popover menu to a button. Not just any simple on-hover behavior, but one that stays open if the user is heading toward the content.">
    
  <meta name="twitter:image" content="https://s3-us-west-1.amazonaws.com/runnable-design/tw-image.png">
  
</head>


  <body class="page-landing">

    <svg xmlns="http://www.w3.org/2000/svg" class="icon-defintions">
  <symbol id="icons-bitbucket" viewBox="0 0 27.438 31.681">
    <path d='M29.208,3.519a3.47,3.47,0,0,0-.729-0.738,8.244,8.244,0,0,0-2.01-1.1A21.7,21.7,0,0,0,21.768.45,39.134,39.134,0,0,0,10.037.434,24.268,24.268,0,0,0,6,1.385,10.419,10.419,0,0,0,3.525,2.549a4.165,4.165,0,0,0-.976.869,1.832,1.832,0,0,0-.4,1.479C2.32,5.989,2.48,7.082,2.66,8.169q0.4,2.417.811,4.828c0.306,1.787.62,3.573,0.918,5.36a2.026,2.026,0,0,0,.526,1.07,5.663,5.663,0,0,0,.574.543,9.178,9.178,0,0,0,2.432,1.354,20.379,20.379,0,0,0,6.485,1.328,25.257,25.257,0,0,0,4.838-.187,19.46,19.46,0,0,0,4.011-.948,10.809,10.809,0,0,0,2.725-1.382,4.323,4.323,0,0,0,.945-0.9,1.791,1.791,0,0,0,.354-0.805c0.4-2.341.809-4.679,1.2-7.021,0.362-2.172.7-4.346,1.058-6.518A1.78,1.78,0,0,0,29.208,3.519ZM15.82,19.64a4.361,4.361,0,1,1,4.386-4.334A4.359,4.359,0,0,1,15.82,19.64Zm8.7-15.246a1.832,1.832,0,0,1-.436.357,5.524,5.524,0,0,1-1.454.541,20.191,20.191,0,0,1-2.9.485,37.5,37.5,0,0,1-3.791.188,37.891,37.891,0,0,1-4.332-.238,15.852,15.852,0,0,1-3.146-.633,6.893,6.893,0,0,1-.883-0.381,1.385,1.385,0,0,1-.386-0.3A0.443,0.443,0,0,1,7.2,3.746,1.752,1.752,0,0,1,7.61,3.43a5.392,5.392,0,0,1,1.359-.512,20.355,20.355,0,0,1,2.994-.509,37.618,37.618,0,0,1,4.967-.172,30.478,30.478,0,0,1,4.55.431,10.33,10.33,0,0,1,2.075.545,5.336,5.336,0,0,1,.683.346,1.085,1.085,0,0,1,.288.266A0.422,0.422,0,0,1,24.522,4.394Zm1.664,18.367a0.955,0.955,0,0,1-.021.271c-0.305,1.6-.614,3.2-0.911,4.811a2.6,2.6,0,0,1-.724,1.377,5.442,5.442,0,0,1-1.448,1.023A12.151,12.151,0,0,1,20,31.274a18.806,18.806,0,0,1-3.563.407,20.746,20.746,0,0,1-5.917-.7,9.9,9.9,0,0,1-2.3-.953,5.078,5.078,0,0,1-1.042-.789,2.6,2.6,0,0,1-.741-1.4c-0.3-1.6-.609-3.207-0.915-4.81A1.12,1.12,0,0,1,5.5,22.79a0.479,0.479,0,0,1,.724-0.423c0.036,0.021.072,0.041,0.105,0.063a13.221,13.221,0,0,0,3.858,1.856,18.062,18.062,0,0,0,3.873.758,19.587,19.587,0,0,0,4.54-.11,16.41,16.41,0,0,0,5.687-1.827c0.354-.194.686-0.43,1.025-0.646a1.715,1.715,0,0,1,.167-0.1A0.48,0.48,0,0,1,26.186,22.761Zm-8.159-7.477a2.185,2.185,0,1,1-2.177-2.193A2.192,2.192,0,0,1,18.027,15.284Z', transform='translate(-2.122)'</<path d="M29.208,3.519a3.47,3.47,0,0,0-.729-0.738,8.244,8.244,0,0,0-2.01-1.1A21.7,21.7,0,0,0,21.768.45,39.134,39.134,0,0,0,10.037.434,24.268,24.268,0,0,0,6,1.385,10.419,10.419,0,0,0,3.525,2.549a4.165,4.165,0,0,0-.976.869,1.832,1.832,0,0,0-.4,1.479C2.32,5.989,2.48,7.082,2.66,8.169q0.4,2.417.811,4.828c0.306,1.787.62,3.573,0.918,5.36a2.026,2.026,0,0,0,.526,1.07,5.663,5.663,0,0,0,.574.543,9.178,9.178,0,0,0,2.432,1.354,20.379,20.379,0,0,0,6.485,1.328,25.257,25.257,0,0,0,4.838-.187,19.46,19.46,0,0,0,4.011-.948,10.809,10.809,0,0,0,2.725-1.382,4.323,4.323,0,0,0,.945-0.9,1.791,1.791,0,0,0,.354-0.805c0.4-2.341.809-4.679,1.2-7.021,0.362-2.172.7-4.346,1.058-6.518A1.78,1.78,0,0,0,29.208,3.519ZM15.82,19.64a4.361,4.361,0,1,1,4.386-4.334A4.359,4.359,0,0,1,15.82,19.64Zm8.7-15.246a1.832,1.832,0,0,1-.436.357,5.524,5.524,0,0,1-1.454.541,20.191,20.191,0,0,1-2.9.485,37.5,37.5,0,0,1-3.791.188,37.891,37.891,0,0,1-4.332-.238,15.852,15.852,0,0,1-3.146-.633,6.893,6.893,0,0,1-.883-0.381,1.385,1.385,0,0,1-.386-0.3A0.443,0.443,0,0,1,7.2,3.746,1.752,1.752,0,0,1,7.61,3.43a5.392,5.392,0,0,1,1.359-.512,20.355,20.355,0,0,1,2.994-.509,37.618,37.618,0,0,1,4.967-.172,30.478,30.478,0,0,1,4.55.431,10.33,10.33,0,0,1,2.075.545,5.336,5.336,0,0,1,.683.346,1.085,1.085,0,0,1,.288.266A0.422,0.422,0,0,1,24.522,4.394Zm1.664,18.367a0.955,0.955,0,0,1-.021.271c-0.305,1.6-.614,3.2-0.911,4.811a2.6,2.6,0,0,1-.724,1.377,5.442,5.442,0,0,1-1.448,1.023A12.151,12.151,0,0,1,20,31.274a18.806,18.806,0,0,1-3.563.407,20.746,20.746,0,0,1-5.917-.7,9.9,9.9,0,0,1-2.3-.953,5.078,5.078,0,0,1-1.042-.789,2.6,2.6,0,0,1-.741-1.4c-0.3-1.6-.609-3.207-0.915-4.81A1.12,1.12,0,0,1,5.5,22.79a0.479,0.479,0,0,1,.724-0.423c0.036,0.021.072,0.041,0.105,0.063a13.221,13.221,0,0,0,3.858,1.856,18.062,18.062,0,0,0,3.873.758,19.587,19.587,0,0,0,4.54-.11,16.41,16.41,0,0,0,5.687-1.827c0.354-.194.686-0.43,1.025-0.646a1.715,1.715,0,0,1,.167-0.1A0.48,0.48,0,0,1,26.186,22.761Zm-8.159-7.477a2.185,2.185,0,1,1-2.177-2.193A2.192,2.192,0,0,1,18.027,15.284Z" transform="translate(-2.122)"/>
  </symbol>
  <symbol id="icons-check" viewBox='0 0 14.5 10'>
    <path d="M7.25,14a1,1,0,0,1-.707-0.293l-4.5-4.5A1,1,0,0,1,3.457,7.793L7.25,11.586l7.293-7.293a1,1,0,0,1,1.414,1.414l-8,8A1,1,0,0,1,7.25,14Z" transform="translate(-1.75 -4)"/>
  </symbol>
  <symbol id="icons-chevron-right" viewBox='0 0 11 18'>
    <polyline points="1 1 10 9 1 17" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2"/>
  </symbol>
  <symbol id="icons-chevron-down" viewBox='0 0 18 11'>
    <polyline points="17 1 9 10 1 1" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2"></polyline>
  </symbol>
  <symbol id="icons-close" viewBox="0 0 30 30">
    <path d="M21,22.2c-0.3,0-0.5-0.1-0.7-0.3L15,16.6l-5.3,5.3c-0.4,0.4-1,0.4-1.4,0s-0.4-1,0-1.4l5.3-5.3L8.3,9.9c-0.4-0.4-0.4-1,0-1.4s1-0.4,1.4,0l5.3,5.3l5.3-5.3c0.4-0.4,1-0.4,1.4,0s0.4,1,0,1.4l-5.3,5.3l5.3,5.3c0.4,0.4,0.4,1,0,1.4C21.5,22.1,21.3,22.2,21,22.2z"/>
  </symbol>
  <symbol id="icons-external" viewBox="0 0 15 15">
    <path fill="currentColor" d="M9.5,9a0.5,0.5,0,0,1-.354-0.854L14.293,3H11a0.5,0.5,0,0,1,0-1h4.506a0.5,0.5,0,0,1,.32.121h0a0.56,0.56,0,0,1,.07.074,0.5,0.5,0,0,1,.1.269c0,0.013,0,.026,0,0.039V7a0.5,0.5,0,0,1-1,0V3.707L9.854,8.854A0.5,0.5,0,0,1,9.5,9Z" transform="translate(-1 -2)"/><path d="M13.317,8.218L13,8.535V14a2,2,0,0,1-2,2H4a2,2,0,0,1-2-2V7A2,2,0,0,1,4,5H9.465l0.317-.317A2.5,2.5,0,0,1,9.027,4H4A3,3,0,0,0,1,7v7a3,3,0,0,0,3,3h7a3,3,0,0,0,3-3V8.973A2.5,2.5,0,0,1,13.317,8.218Z" transform="translate(-1 -2)"/>
  </symbol>
  <symbol id="icons-github" viewBox="0 0 24 23.41">
    <path d="M24.336,7.791A12.011,12.011,0,0,1,25.52,23.366a12.083,12.083,0,0,1-5.883,4.313A0.686,0.686,0,0,1,19,27.549a0.648,0.648,0,0,1-.187-0.457l0.023-3.281a3.861,3.861,0,0,0-.258-1.395,2.219,2.219,0,0,0-.562-0.832,7.008,7.008,0,0,0,3.738-1.348Q23.41,19.03,23.5,15.655a5.127,5.127,0,0,0-.34-1.782,4.569,4.569,0,0,0-.9-1.43,3.254,3.254,0,0,0,.234-1.078,4.936,4.936,0,0,0-.352-2.109,1.719,1.719,0,0,0-.8.035A7.4,7.4,0,0,0,18.84,10.5a11.493,11.493,0,0,0-6,0,7.4,7.4,0,0,0-2.508-1.207,1.719,1.719,0,0,0-.8-0.035,4.936,4.936,0,0,0-.352,2.109,3.254,3.254,0,0,0,.234,1.078,4.569,4.569,0,0,0-.9,1.43,5.127,5.127,0,0,0-.34,1.782Q8.27,19.03,9.91,20.237a6.976,6.976,0,0,0,3.75,1.348,1.934,1.934,0,0,0-.48.633,3.414,3.414,0,0,0-.293.984,3.316,3.316,0,0,1-1.594.293,2.42,2.42,0,0,1-1.9-1.3,3.234,3.234,0,0,0-.645-0.75,1.767,1.767,0,0,0-1.184-.469q-0.7.023-.527,0.3a1.324,1.324,0,0,0,.551.469,2.583,2.583,0,0,1,.75.82,5.653,5.653,0,0,1,.469.867,2.2,2.2,0,0,0,.984,1.172,4.5,4.5,0,0,0,3.047.258l0.023,2.227a0.648,0.648,0,0,1-.187.457,0.686,0.686,0,0,1-.633.129A12.083,12.083,0,0,1,6.16,23.366,12,12,0,0,1,24.336,7.791Z" transform="translate(-3.84 -4.287)"/>
  </symbol>
  <symbol id="icons-life-preserver" viewBox='0 0 18 18'>
    <path d="M9,17A8,8,0,1,0,1,9,8,8,0,0,0,9,17ZM9,5A4,4,0,1,1,5,9,4,4,0,0,1,9,5Z" transform="translate(-1 -1)" fill="#fff"/><path d="M9,2A7,7,0,1,1,2,9,7.008,7.008,0,0,1,9,2M9,13.5A4.5,4.5,0,1,0,4.5,9,4.505,4.505,0,0,0,9,13.5M9,1a8,8,0,1,0,8,8A8,8,0,0,0,9,1H9ZM9,12.5A3.5,3.5,0,1,1,12.5,9,3.5,3.5,0,0,1,9,12.5H9Z" transform="translate(-1 -1)"/><path d="M5.259,7.623A3.989,3.989,0,0,1,7.623,5.259L4.654,2.289A8.032,8.032,0,0,0,2.29,4.653Z" transform="translate(-1 -1)"/><path d="M12.741,10.377a3.989,3.989,0,0,1-2.364,2.364l2.969,2.969a8.032,8.032,0,0,0,2.364-2.364Z" transform="translate(-1 -1)"/><path d="M7.623,12.741a3.989,3.989,0,0,1-2.364-2.364L2.289,13.346A8.032,8.032,0,0,0,4.653,15.71Z" transform="translate(-1 -1)"/><path d="M10.377,5.259a3.989,3.989,0,0,1,2.364,2.364l2.969-2.969A8.032,8.032,0,0,0,13.347,2.29Z" transform="translate(-1 -1)"/>
  </symbol>
  <symbol id="icons-overflow" viewBox="0 0 18 4.688">
    <path fill="currentColor" d="M2.344,7.656A1.344,1.344,0,1,1,1,9,1.345,1.345,0,0,1,2.344,7.656m0-1A2.344,2.344,0,1,0,4.688,9,2.344,2.344,0,0,0,2.344,6.656h0Z" transform="translate(0 -6.656)"/><path fill="currentColor" d="M9,7.656A1.344,1.344,0,1,1,7.656,9,1.345,1.345,0,0,1,9,7.656m0-1A2.344,2.344,0,1,0,11.344,9,2.344,2.344,0,0,0,9,6.656H9Z" transform="translate(0 -6.656)"/><path fill="currentColor" d="M15.656,7.656A1.344,1.344,0,1,1,14.313,9a1.345,1.345,0,0,1,1.344-1.344m0-1A2.344,2.344,0,1,0,18,9a2.344,2.344,0,0,0-2.344-2.344h0Z" transform="translate(0 -6.656)"/>
  </symbol>
</svg>

    <header class="grid-block shrink header">
  <div class="grid-block grid-container justify-justified">
    <a href="/" class="grid-content shrink logo">
      <img class="img" src="https://runnable.com/images/runnable-logo.svg" height="36" width="192">
    </a>
    <nav class="nav grid-block shrink">
      <a href="/docs/" class="grid-content btn btn-sm text-white weight-strong hidden-xs a">Docs</a>
      <a href="/product/" class="grid-content btn btn-sm text-white weight-strong hidden-sm a">Product</a>
      <a href="/pricing/" class="grid-content btn btn-sm text-white weight-strong hidden-md">Pricing</a>
      <a href="/signin" class="grid-content btn btn-sm text-white weight-strong hidden-md js-hide-if-signed-in">Sign In</a>
      <a href="/signup" class="grid-content btn btn-sm btn-white text-white weight-strong hidden-xs js-hide-if-signed-in track-sign-up">Sign Up</a>
      <div class="grid-content btn btn-sm btn-overflow popover-trigger hover has-links" tabindex="1">
        <svg class="icons icons-overflow">
          <use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#icons-overflow"></use>
        </svg>
        <div class="popover-hover-wrapper right-align-sm">
  <div class="grid-block popover popover-header-menu bottom">
    <div class="grid-block col list text-left">
      <a data-target="#sign-up" class="list-item-a visible-xs js-hide-if-signed-in track-sign-up">Sign Up</a>
      <a data-target="#sign-in" class="list-item-a visible-md js-hide-if-signed-in">Sign In</a>
      <div class="list-item divider visible-md"></div>
      <a href="/docs/" class="list-item-a visible-xs">Docs</a>
      <a href="/for/" class="list-item-a visible-sm">Product</a>
      <a href="/pricing/" class="list-item-a visible-md"><span class="text-request">Pricing</a>
      <a href="/how-it-works/" class="list-item-a">How It Works</a>
      <a href="/demo/" class="list-item-a">Request Demo</a>
      <a href="/blog/" class="list-item-a">Blog</a>
      <a href="/about/" class="list-item-a">About</a>
    </div>
  </div>
</div>

      </div>
    </nav>
  </div>
</header>


    <main class="grid-block col main">
      <div class="grid-block col align-center hero">
  <h1 class="h1 text-center weight-strong margin-top-sm">Amazon-like Popover Trigger Behaviors in AngularJS</h1>
</div>

<div class="grid-block grid-container col noscroll">
  <div class="grid-block align-center col post-details">
    
    <img class="avatar" src="images/authors/nathanmeyers.jpg" width="45" height="45">
    <div>by Nathan Meyers</div>
    <div>yesterday in Engineering</div>
    <div class="grid-block social-sharing" data-url="http://runnable.com/blog/amazon-like-popover-trigger-behaviors-in-angularjs" data-legacy-url="">
      <a target="_blank" href="http://twitter.com/intent/tweet?url=http://runnable.com/blog/amazon-like-popover-trigger-behaviors-in-angularjs&via=GetRunnable" class="share-item share-twitter">
        <img src="images/logos/logo-twitter.svg" width="20" height="20">
        <span class="share-count small">0</span>
      </a>
      <a target="_blank" href="http://www.linkedin.com/shareArticle?mini=true&url=http://runnable.com/blog/amazon-like-popover-trigger-behaviors-in-angularjs" class="share-item share-linkedin">
        <img src="images/logos/logo-linkedin.svg" width="20" height="20">
        <span class="share-count small">0</span>
      </a>
      <a target="_blank" href="#" class="share-item share-hackernews hidden">
        <img src="images/logos/logo-hackernews.svg" width="20" height="20">
        <span class="share-count small">0</span>
      </a>
    </div>
  </div>
  <article class="article article-body">
    <p><img src="images/posts/popover-animation.gif" alt="popover animation" /></p>

<p>[<a href="https://jsfiddle.net/dominathan/007cvsr8/">DEMO</a>]</p>

<p>Creating custom UI behavior in Angular can seem daunting. Once you know how to break the problem down, its complexity can just fizzle away. In this tutorial, we’ll be exploring the use of mouse events, locations, and some simple geometry to add an on-hover popover menu to a button. Not just any simple on-hover behavior, but one that stays open if the user is heading toward the content.</p>

<p>I want to point out I am not the first person to <a href="http://bjk5.com/post/44698559168/breaking-down-amazons-mega-dropdown">write about this behavior</a>, and I’m not the first to <a href="https://css-tricks.com/dropdown-menus-with-more-forgiving-mouse-movement-paths/">discuss implementations</a>. This UI concept has been around for years, and has been implemented in many different ways by many different people. It’s a fun problem with multiple right answers, and a great example to explain custom UI behavior in AngularJs.</p>

<h3 id="lets-break-it-down">Let’s break it down!</h3>

<p>We can divide the work for this popover into easily doable pieces:</p>

<ol>
  <li>When the cursor hovers over the button ➤ show the popover.</li>
  <li>The cursor moves toward the popover ➤ popover stays open.</li>
  <li>The cursor moves away from the popover ➤ popover closes.</li>
  <li>The cursor can select an item in the popover.</li>
</ol>

<p>By breaking the flow down, we can plan out the events we need to make the behavior. We’ll also look at how to divide the behavior into distinct states, so we can make a flow diagram.</p>

<p><img src="images/posts/popover-state-diagram.png" alt="popover state diagram" /></p>

<p>From this, we see three places where we need to “make decisions”:</p>

<ol>
  <li>Is the cursor on the button?</li>
  <li>Is the cursor heading toward the popover?</li>
  <li>Is the cursor on the popover?</li>
</ol>

<p>Using <code class="highlighter-rouge">on-mouse</code> events, we can translate this flow into checks and events, like this:</p>

<p><img src="images/posts/popover-checks-events-diagram.png" alt="popover checks and events diagram" /></p>

<p>That doesn’t look too hard to implement! Figuring out if the cursor is on the path is a little trickier, so let’s mock that out for now as <code class="highlighter-rouge">isOnPath</code>. For the easy part, we’ll work on mouse events on the <code class="highlighter-rouge">popoverElement</code> and the <code class="highlighter-rouge">buttonElement</code>.</p>

<p>First, let’s make the <code class="highlighter-rouge">onButtonEnter</code> method. This method will be attached to the <code class="highlighter-rouge">button.on(‘mouseenter’)</code> listener when the directive is loaded:</p>

<figure class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="nx">buttonElement</span><span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="s1">'mouseenter'</span><span class="p">,</span> <span class="nx">onButtonEnter</span><span class="p">);</span>

<span class="kd">function</span> <span class="nx">onButtonEnter</span><span class="p">(</span><span class="nx">e</span><span class="p">)</span> <span class="p">{</span>
  <span class="c1">// given function to open the popover</span>
  <span class="nx">openPopover</span><span class="p">(</span><span class="nx">e</span><span class="p">);</span>
  <span class="c1">// transition to leave-button state</span>
  <span class="nx">buttonElement</span><span class="p">.</span><span class="nx">one</span><span class="p">(</span><span class="s1">'mouseleave'</span><span class="p">,</span> <span class="nx">onButtonLeave</span><span class="p">);</span>
<span class="p">}</span></code></pre></figure>

<p>Once the cursor leaves the button, we need to:</p>

<figure class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="kd">function</span> <span class="nx">onButtonLeave</span><span class="p">()</span> <span class="p">{</span>
  <span class="c1">// transition to the popover state</span>
  <span class="nx">popoverElement</span><span class="p">.</span><span class="nx">one</span><span class="p">(</span><span class="s1">'mouseenter'</span><span class="p">,</span> <span class="nx">onPopoverEnter</span><span class="p">);</span>
  <span class="c1">// listen to the mouse movement on the document to check the path</span>
  <span class="nx">$document</span><span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="s1">'mousemove'</span><span class="p">,</span> <span class="nx">isOnPath</span><span class="p">);</span>
<span class="p">};</span></code></pre></figure>

<p>Then we need to fill in the events for the popover. When the popover is entered, we need to:</p>

<figure class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="kd">function</span> <span class="nx">onPopoverEnter</span><span class="p">(</span><span class="nx">e</span><span class="p">)</span> <span class="p">{</span>
  <span class="c1">// stop listening to the path because we made it to the destination</span>
  <span class="nx">$document</span><span class="p">.</span><span class="nx">off</span><span class="p">(</span><span class="s1">'mousemove'</span><span class="p">,</span> <span class="nx">isOnPath</span><span class="p">);</span>
  <span class="c1">// Add a listener to the mouse leave so we can hide the popover</span>
  <span class="nx">popoverElement</span><span class="p">.</span><span class="nx">one</span><span class="p">(</span><span class="s1">'mouseleave'</span><span class="p">,</span> <span class="nx">hidePopOver</span><span class="p">);</span>
<span class="p">}</span></code></pre></figure>

<p>When closing the popover, we should try to clean up everything that we can.</p>

<figure class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="kd">function</span> <span class="nx">cleanupPopover</span><span class="p">()</span> <span class="p">{</span>
  <span class="c1">// this is called in the closePopover() function</span>
  <span class="c1">// remove all listeners from the popover</span>
  <span class="nx">popoverElement</span><span class="p">.</span><span class="nx">off</span><span class="p">(</span><span class="s1">'mouseleave'</span><span class="p">);</span>
  <span class="nx">popoverElement</span><span class="p">.</span><span class="nx">off</span><span class="p">(</span><span class="s1">'mouseenter'</span><span class="p">);</span>
  <span class="c1">// stop listening to the mouse movement on the document</span>
  <span class="nx">$document</span><span class="p">.</span><span class="nx">off</span><span class="p">(</span><span class="s1">'mousemove'</span><span class="p">,</span> <span class="nx">isOnPath</span><span class="p">);</span>
<span class="p">}</span></code></pre></figure>

<h3 id="now-the-tricky-part">Now the tricky part.</h3>

<p>How do we figure out the user is heading toward the popover? We’re going to keep it simple, by making a shape between the button and the popover, and validating if the cursor is inside.</p>

<p>First, we need to define our shape. The vertices of the shape depend on the location of the popover relative to the button (top, right, bottom, or left)</p>

<p>To make the vertices easy to access, we’ll lay them out into objects.</p>

<figure class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="kd">var</span> <span class="nx">popoverClientRect</span> <span class="o">=</span> <span class="nx">popoverElement</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="nx">getBoundingClientRect</span><span class="p">();</span>
<span class="kd">var</span> <span class="nx">elementClientRect</span> <span class="o">=</span> <span class="nx">element</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="nx">getBoundingClientRect</span><span class="p">();</span>

<span class="kd">var</span> <span class="nx">popoverRect</span> <span class="o">=</span> <span class="p">{</span>
 <span class="na">topLeft</span> <span class="p">:</span> <span class="p">[</span><span class="nx">popoverClientRect</span><span class="p">.</span><span class="nx">left</span><span class="p">,</span> <span class="nx">popoverClientRect</span><span class="p">.</span><span class="nx">top</span><span class="p">],</span>
 <span class="na">topRight</span><span class="p">:</span> <span class="p">[</span><span class="nx">popoverClientRect</span><span class="p">.</span><span class="nx">right</span><span class="p">,</span> <span class="nx">popoverClientRect</span><span class="p">.</span><span class="nx">top</span><span class="p">],</span>
 <span class="na">bottomLeft</span> <span class="p">:</span> <span class="p">[</span><span class="nx">popoverClientRect</span><span class="p">.</span><span class="nx">left</span><span class="p">,</span> <span class="nx">popoverClientRect</span><span class="p">.</span><span class="nx">bottom</span><span class="p">],</span>
 <span class="na">bottomRight</span><span class="p">:</span> <span class="p">[</span><span class="nx">popoverClientRect</span><span class="p">.</span><span class="nx">right</span><span class="p">,</span> <span class="nx">popoverClientRect</span><span class="p">.</span><span class="nx">bottom</span><span class="p">]</span>
<span class="p">};</span>
<span class="kd">var</span> <span class="nx">elementRect</span> <span class="o">=</span> <span class="p">{</span>
 <span class="na">topLeft</span> <span class="p">:</span> <span class="p">[</span><span class="nx">elementClientRect</span><span class="p">.</span><span class="nx">left</span><span class="p">,</span> <span class="nx">elementClientRect</span><span class="p">.</span><span class="nx">top</span><span class="p">],</span>
 <span class="na">topRight</span><span class="p">:</span> <span class="p">[</span><span class="nx">elementClientRect</span><span class="p">.</span><span class="nx">right</span><span class="p">,</span> <span class="nx">elementClientRect</span><span class="p">.</span><span class="nx">top</span><span class="p">],</span>
 <span class="na">bottomLeft</span> <span class="p">:</span> <span class="p">[</span><span class="nx">elementClientRect</span><span class="p">.</span><span class="nx">left</span><span class="p">,</span> <span class="nx">elementClientRect</span><span class="p">.</span><span class="nx">bottom</span><span class="p">],</span>
 <span class="na">bottomRight</span><span class="p">:</span> <span class="p">[</span><span class="nx">elementClientRect</span><span class="p">.</span><span class="nx">right</span><span class="p">,</span> <span class="nx">elementClientRect</span><span class="p">.</span><span class="nx">bottom</span><span class="p">]</span>
<span class="p">};</span></code></pre></figure>

<p>To tell the popover where to be in relation to the button, we add the classes <code class="highlighter-rouge">top</code>, <code class="highlighter-rouge">right</code>, <code class="highlighter-rouge">bottom</code>, or <code class="highlighter-rouge">left</code>. We can check if the class exists on the popover, and use that to figure out the shape. Using this, we can return the arrays.</p>

<figure class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="kd">function</span> <span class="nx">getPath</span><span class="p">()</span> <span class="p">{</span>
  <span class="k">if</span> <span class="p">(</span><span class="nx">popoverElement</span><span class="p">.</span><span class="nx">hasClass</span><span class="p">(</span><span class="s1">'bottom'</span><span class="p">))</span> <span class="p">{</span>
    <span class="k">return</span> <span class="p">[</span>
      <span class="nx">elementRect</span><span class="p">.</span><span class="nx">topLeft</span><span class="p">,</span>
      <span class="nx">popoverRect</span><span class="p">.</span><span class="nx">topLeft</span><span class="p">,</span>
      <span class="nx">popoverRect</span><span class="p">.</span><span class="nx">topRight</span><span class="p">,</span>
      <span class="nx">elementRect</span><span class="p">.</span><span class="nx">topRight</span>
    <span class="p">];</span>
  <span class="p">}</span>
  <span class="k">if</span> <span class="p">(</span><span class="nx">popoverElement</span><span class="p">.</span><span class="nx">hasClass</span><span class="p">(</span><span class="s1">'top'</span><span class="p">))</span> <span class="p">{</span>
    <span class="k">return</span> <span class="p">[</span>
      <span class="nx">popoverRect</span><span class="p">.</span><span class="nx">bottomLeft</span><span class="p">,</span>
      <span class="nx">elementRect</span><span class="p">.</span><span class="nx">bottomLeft</span><span class="p">,</span>
      <span class="nx">elementRect</span><span class="p">.</span><span class="nx">bottomRight</span><span class="p">,</span>
      <span class="nx">popoverRect</span><span class="p">.</span><span class="nx">bottomRight</span>
    <span class="p">];</span>
  <span class="p">}</span>
  <span class="k">if</span> <span class="p">(</span><span class="nx">popoverElement</span><span class="p">.</span><span class="nx">hasClass</span><span class="p">(</span><span class="s1">'left'</span><span class="p">))</span> <span class="p">{</span>
    <span class="k">return</span> <span class="p">[</span>
      <span class="nx">popoverRect</span><span class="p">.</span><span class="nx">bottomRight</span><span class="p">,</span>
      <span class="nx">popoverRect</span><span class="p">.</span><span class="nx">topRight</span><span class="p">,</span>
      <span class="nx">elementRect</span><span class="p">.</span><span class="nx">topRight</span><span class="p">,</span>
      <span class="nx">elementRect</span><span class="p">.</span><span class="nx">bottomRight</span>
    <span class="p">];</span>
  <span class="p">}</span>
  <span class="k">return</span> <span class="p">[</span>
    <span class="nx">elementRect</span><span class="p">.</span><span class="nx">topLeft</span><span class="p">,</span>
    <span class="nx">elementRect</span><span class="p">.</span><span class="nx">bottomLeft</span><span class="p">,</span>
    <span class="nx">popoverRect</span><span class="p">.</span><span class="nx">bottomLeft</span><span class="p">,</span>
    <span class="nx">popoverRect</span><span class="p">.</span><span class="nx">topLeft</span>
  <span class="p">];</span>
<span class="p">}</span></code></pre></figure>

<p>Now that we have our shape, we need a way to check if the cursor is in it. There are a few existing libraries for this, so we’ll use <a href="https://github.com/substack/point-in-polygon">this one that I found a while back</a>. It takes an array of [x,y] values for the point, so it’s perfect. All that we have left to implement is <code class="highlighter-rouge">isOnPath</code>:</p>

<figure class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="kd">function</span> <span class="nx">isOnPath</span><span class="p">(</span><span class="nx">event</span><span class="p">)</span> <span class="p">{</span>
  <span class="kd">var</span> <span class="nx">path</span> <span class="o">=</span> <span class="nx">getPath</span><span class="p">();</span>
  <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">pointInPolygon</span><span class="p">([</span><span class="nx">event</span><span class="p">.</span><span class="nx">clientX</span><span class="p">,</span> <span class="nx">event</span><span class="p">.</span><span class="nx">clientY</span><span class="p">],</span> <span class="nx">path</span><span class="p">))</span> <span class="p">{</span>
    <span class="nx">hidePopOver</span><span class="p">();</span>
  <span class="p">}</span>
<span class="p">}</span></code></pre></figure>

<p>The key to solving any problem is breaking it down into the smallest possible problems, and solving those one at a time. And that’s about it! Below, I’ve added a JSFiddle with the implementation. Try it out and play with it!</p>

<p>[<a href="https://jsfiddle.net/dominathan/007cvsr8/">DEMO</a>]</p>

  </article>

  <section class="grid-block col shrink justify-center align-center section-footer">
    <a class="grid-block shrink link text-center margin-bottom-lg margin-top-lg" href="/blog/">View All Posts</a>
    <div id="mc_embed_signup" class="grid-block justify-center">
  <form action="//runnable.us5.list-manage.com/subscribe/post?u=a67ad168d3259d6b0f4d103df&amp;id=504370029e" method="post" id="mc-embedded-subscribe-form" name="mc-embedded-subscribe-form" class="validate" target="_blank" novalidate="">
    <div id="mc_embed_signup_scroll" class="grid-block col-xs mailchimp-form">
      <div class="mc-field-group">
        <input type="email" value="" name="EMAIL" class="input input-md" id="mce-EMAIL" placeholder="Your email">
      </div>
      <div id="mce-responses" class="clear">
        <div class="response" id="mce-error-response" style="display:none"></div>
        <div class="response" id="mce-success-response" style="display:none"></div>
      </div>
      <!-- real people should not fill this in and expect good things - do not remove this or risk form bot signups-->
      <div style="position: absolute; left: -5000px;" aria-hidden="true">
        <input type="text" name="b_a67ad168d3259d6b0f4d103df_504370029e" tabindex="-1" value="">
      </div>
      <div class="clear grid-block justify-center">
        <input type="submit" value="Subscribe to New Posts" name="subscribe" id="mc-embedded-subscribe" class="btn btn-md gray">
      </div>
    </div>
  </form>
</div>
  </section>
</div>

<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.11.0/jquery.min.js"></script>
<script src="js/social-buttons.js"></script>

    </main>

    <footer class="grid-block col footer justify-spaced">
  <a href="https://runnable.com/signup" class="sign-up-box grid-block col well well-anchor track-sign-up">
  <img class="img no-touching" src="/blog/images/runnabear-hello.png">
  <p class="p">Try Runnable! It’s <strong class="weight-strong">free</strong> for 14 days.
  <div data-target="#sign-up" class="btn btn-sm green track-sign-up">Sign Up</div>
</a>

  <aside class="grid-block aside-support">
  <div class="grid-block col justify-center support-text">
    <p class="p weight-strong">Our engineers are here for you.</p>
    <p class="p">We can answer questions about Docker <br class="br">and help you set up your stack.</p>
  </div>
  <figure class="grid-block col figure shrink">
    <div class="grid-block shrink bubble">
      <img class="img float-left" src="/blog/images/logos/logo-slack.svg" height="18" width="18" alt="Slack">
      <div class="grid-block col">
        <div class="user">
          <strong class="strong user-name">Jorge</strong>
          <span class="user-time"> 4:19 PM</span>
        </div>
        <p class="p user-text">Can I run multiple commands?</p>
      </div>
    </div>
    <div class="grid-block shrink bubble">
      <img class="img float-left" src="/blog/images/runnabot-head.png" height="18" width="18" alt="Slack">
      <div class="grid-block col">
        <div class="user">
          <strong class="strong user-name">Taylor</strong>
          <span class="user-time"> 4:20 PM</span>
        </div>
        <p class="p user-text">Hi <span class="link-blue">@jorge</span>!
          <br>Yes you can. Here’s how: …
        </p>
      </div>
    </div>
  </figure>
</aside>

  <div class="grid-block link-wrapper">
    <div class="grid-block col align-start">
      <a href="/docs/" class="btn btn-xs link weight-strong">Docs</a>
      <a href="/for/" class="btn btn-xs link weight-strong">Product</a>
      <a href="/pricing/" class="btn btn-xs link weight-strong">Pricing</a>
      <a href="/how-it-works/" class="btn btn-xs link weight-strong">How It Works</a>
      <a href="https://runnable.com/docker/" class="btn btn-xs link weight-strong">Docker Guides</a>
      <a href="/demo/" class="btn btn-xs link weight-strong">Request Demo</a>
    </div>
    <div class="grid-block col align-start">
      <a href="https://runnable.com/use-cases/" class="btn btn-xs link weight-strong">Use Cases</a>
      <a href="/blog/" class="btn btn-xs link weight-strong">Blog</a>
      <a href="/about/" class="btn btn-xs link weight-strong">About</a>
      <a href="/legal/privacy-policy/" class="btn btn-xs link weight-strong">Privacy</a>
      <a href="/legal/terms-of-service/" class="btn btn-xs link weight-strong">Terms</a>
      <a href="/legal/acceptable-use-policy/" class="btn btn-xs link weight-strong">Acceptable Use</a>
    </div>
  </div>
</footer>


  </body>

</html>
